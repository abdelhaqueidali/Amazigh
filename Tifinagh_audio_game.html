<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ⵜⴰⵙⵓⵔⴰⵔⵜ ⵏ ⵜⴼⵉⵏⴰⵖ</title>
    <!-- Google Fonts - Noto Sans Tifinagh -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Tifinagh&display=swap" rel="stylesheet">
    <style>
        /*  (PASTE THE ENTIRE CSS CODE FROM YOUR PREVIOUS GAME EXAMPLE HERE) */
        body {
            font-family: 'Arial', sans-serif; /* A common, readable font. */
            margin: 0;
            padding: 0;
            background-color: #f8f8f8;
            color: #333;
            line-height: 1.6;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }

        /*  Container for the entire page content */
        .container {
            width: 90%;
            max-width: 1200px;
            margin: 20px auto;
            background-color: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            flex: 1; /* Allow to grow */
        }

        /*  Header Styles */
        header {
            background-color: #4CAF50; /*  Green */
            color: #fff;
            padding: 10px 0;
            text-align: center;
            border-radius: 8px 8px 0 0;
        }

        header h1 {
            margin: 0;
            font-size: 2.5em;
        }

        /*  Navigation Menu Styles */
        .nav-toggle {
            display: block;
            width: 100%;
            padding: 10px;
            background-color: #333;
            color: #fff;
            text-align: center;
            cursor: pointer;
            border: none;
            border-radius: 5px;
            margin-bottom: 10px;
        }

        /*  --- GAME-SPECIFIC STYLES (Modified to fit the overall design) --- */

        #game-container {
            /*  Use the .container styles as a base, then override */
            width: 90%;
            max-width: 600px; /*  Limit width for better readability on larger screens */
            margin: 20px auto; /* Center */
            background-color: #fff;
            padding: 2em; /* More padding */
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            text-align: center; /* Ensure text is centered */
        }

        #game-container h1 {
            color: #4CAF50; /* Consistent green */
            margin-bottom: 1em;
            border-bottom: 2px solid #4CAF50; /* Simpler underline */
            padding-bottom: 0.5em;
            font-size: 2em; /* Slightly smaller */
        }

        #question {
            font-size: 3em;
            margin-bottom: 1em;
            min-height: 1.5em;
            color: #007bff; /* Blue for the question */
        }

        #choices {
            display: grid;
            grid-template-columns: repeat(2, 1fr); /* Two columns */
            gap: 1em;
            margin-bottom: 1em;
        }

        .choice {
            background-color: #f0f8f1; /* Light green from the table */
            color: #333; /* Dark text */
            padding: 1em;
            border: 2px solid #4CAF50; /* Green border */
            border-radius: 8px;
            cursor: pointer;
            font-size: 1.5em;
            transition: background-color 0.3s ease, transform 0.1s ease; /* Add transform */
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            outline: none;
        }

        .choice:hover:not(:disabled),
        .choice:focus:not(:disabled) {
            background-color: #c8e6c9; /* Slightly darker green on hover */
            transform: scale(1.05); /* Slightly enlarge on hover */
        }

        .choice:focus {
            outline: none;
             box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .correct {
            background-color: #4CAF50 !important; /* Green, and use !important */
            color: white !important; /* White text for contrast */
            border-color: #388e3c !important; /* Darker green border */
        }

        .incorrect {
            background-color: #f44336 !important; /* Red */
            color: white !important;
            border-color: #d32f2f !important; /* Darker red border */
        }
        .correct-container {
            background-color: #a5d6a7; /* Light green background */
            transition: background-color 0.3s ease; /* Add transition here */
        }

        #feedback {
            font-size: 1.2em;
            font-weight: bold;
            margin-bottom: 1em;
            min-height: 1.5em;
        }

        #score {
            font-size: 1.2em;
            margin-bottom: 1em;
        }


        #next-button {
            background-color: #4CAF50; /* Consistent green */
            color: #fff;
            padding: 0.8em 1.5em;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1.2em;
            transition: background-color 0.3s ease;
        }

        #next-button:hover {
            background-color: #388e3c; /* Darker green on hover */
        }

        .tifinagh {
            font-family: 'Noto Sans Tifinagh', sans-serif;
            font-size: 1.5em;
        }

        /*  You might not need this, as monospace isn't ideal for the Latin transliteration */
        .latin {
           font-style: italic;
            color: #666;
        }
        /* Style for the audio player */
        .audio-player {
          width: 45px; /* Adjust as needed */
          height: 45px; /* Make it a circle */
          background-color: #4CAF50; /* Your main green color */
          color: white;
          border: none;
          border-radius: 50%; /* Make it a perfect circle */
          cursor: pointer;
          display: inline-flex; /* Use flexbox for centering */
          align-items: center; /* Center vertically */
          justify-content: center; /* Center horizontally */
          font-size: 18px; /* Adjust as needed */
          transition: background-color 0.3s ease;
          overflow: hidden;/* Hide default audio controls */
        }
         /* Custom play icon */
        .audio-player::before {
          content: '▶'; /* Unicode play symbol */
          display: block;
        }

        .audio-player:hover, .audio-player:focus{
            background-color: #388e3c;
        }

        .audio-player:focus{
            outline: none;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        /* Hide the default audio controls */
        .audio-player audio {
          display: none;
        }

        /* Footer Styles (consistent with other pages) */
        footer {
            text-align: center;
            padding: 10px;
            background-color: #333;
            color: #fff;
            border-radius: 0 0 8px 8px;
        }
    </style>
</head>
<body>
    <!--  Use the same header and navigation as the other page -->
    <div class="container">
    <header>
        <h1>Tifinagh Game!</h1>
    </header>
	    <a href="index.html">
        <button class="nav-toggle">ⴰⵙⵏⵓⴱⴳ - Home</button>
	    </a>
    <main>
    <div id="game-container">
        <h1>ⵜⴰⵙⵓⵔⴰⵔⵜ ⵏ ⵢⵉⵙⴽⴽⵉⵍⵏ!</h1>

        <div id="question"></div>
        <div id="choices"></div>
        <div id="feedback"></div>
        <div id="score">ⴰⵏⴽⵙ : <span id="score-value">0</span></div>
        <button id="next-button">ⴹⴼⵉⵕ</button>
    </div>
    </main>
    <footer>
        <p>ⴰⴼⴰⵡ</p>
    </footer>
    </div>
    <script>
    const letters = [
        { tifinagh: 'ⴰ', latin: 'a', audio: 'Letters/01.ogg' },
        { tifinagh: 'ⴱ', latin: 'b', audio: 'Letters/02.ogg' },
        { tifinagh: 'ⴳ', latin: 'g', audio: 'Letters/03.ogg' },
        { tifinagh: 'ⴳⵯ', latin: 'gʷ', audio: 'Letters/04.ogg' },
        { tifinagh: 'ⴷ', latin: 'd', audio: 'Letters/05.ogg' },
        { tifinagh: 'ⴹ', latin: 'ḍ', audio: 'Letters/06.ogg' },
        { tifinagh: 'ⴻ', latin: '-', audio: 'Letters/07.ogg' },
        { tifinagh: 'ⴼ', latin: 'f', audio: 'Letters/08.ogg' },
        { tifinagh: 'ⴽ', latin: 'k', audio: 'Letters/09.ogg' },
        { tifinagh: 'ⴽⵯ', latin: 'kʷ', audio: 'Letters/10.ogg' },
        { tifinagh: 'ⵀ', latin: 'h', audio: 'Letters/11.ogg' },
        { tifinagh: 'ⵃ', latin: 'ḥ', audio: 'Letters/12.ogg' },
        { tifinagh: 'ⵄ', latin: 'ɛ', audio: 'Letters/13.ogg' },
        { tifinagh: 'ⵅ', latin: 'x', audio: 'Letters/14.ogg' },
        { tifinagh: 'ⵇ', latin: 'q', audio: 'Letters/15.ogg' },
        { tifinagh: 'ⵉ', latin: 'i', audio: 'Letters/16.ogg' },
        { tifinagh: 'ⵊ', latin: 'j', audio: 'Letters/17.ogg' },
        { tifinagh: 'ⵍ', latin: 'l', audio: 'Letters/18.ogg' },
        { tifinagh: 'ⵎ', latin: 'm', audio: 'Letters/19.ogg' },
        { tifinagh: 'ⵏ', latin: 'n', audio: 'Letters/20.ogg' },
        { tifinagh: 'ⵓ', latin: 'u', audio: 'Letters/21.ogg' },
        { tifinagh: 'ⵔ', latin: 'r', audio: 'Letters/22.ogg' },
        { tifinagh: 'ⵕ', latin: 'ṛ', audio: 'Letters/23.ogg' },
        { tifinagh: 'ⵖ', latin: 'ɣ', audio: 'Letters/24.ogg' },
        { tifinagh: 'ⵙ', latin: 's', audio: 'Letters/25.ogg' },
        { tifinagh: 'ⵚ', latin: 'ṣ', audio: 'Letters/26.ogg' },
        { tifinagh: 'ⵛ', latin: 'c', audio: 'Letters/27.ogg' },
        { tifinagh: 'ⵜ', latin: 't', audio: 'Letters/28.ogg' },
        { tifinagh: 'ⵟ', latin: 'ṭ', audio: 'Letters/29.ogg' },
        { tifinagh: 'ⵡ', latin: 'w', audio: 'Letters/30.ogg' },
        { tifinagh: 'ⵢ', latin: 'y', audio: 'Letters/31.ogg' },
        { tifinagh: 'ⵣ', latin: 'z', audio: 'Letters/32.ogg' },
        { tifinagh: 'ⵥ', latin: 'ẓ', audio: 'Letters/33.ogg' }
    ];

        let currentQuestion = {};
        let score = 0;
        let questionTimeout;

        const gameContainer = document.getElementById('game-container');
        const questionEl = document.getElementById('question');
        const choicesEl = document.getElementById('choices');
        const feedbackEl = document.getElementById('feedback');
        const scoreEl = document.getElementById('score-value');
        const nextButton = document.getElementById('next-button');
        let questionAudioPlayer = null;  // Global player for the question

        function generateQuestion() {
            clearTimeout(questionTimeout);
            gameContainer.classList.remove('correct-container');
             // Clean up previous question audio player (if any)
            if(questionAudioPlayer){
                questionAudioPlayer.pause();
                questionAudioPlayer = null;
            }

            const correctLetterIndex = Math.floor(Math.random() * letters.length);
            currentQuestion = letters[correctLetterIndex];
            const isAudioQuestion = Math.random() < 0.5;

            if (isAudioQuestion) {
                // Audio Question: Play audio, show letter choices
                questionEl.innerHTML = ""; // Clear text, add audio
                questionAudioPlayer = new Audio(currentQuestion.audio);
                questionAudioPlayer.play();


                questionEl.textContent = "???"; // Show ??? while the audio is playing.


                const choices = [];
                choices.push(currentQuestion.tifinagh); // The correct Tifinagh letter

                while (choices.length < 4) {
                    const randomLetterIndex = Math.floor(Math.random() * letters.length);
                    const randomLetter = letters[randomLetterIndex];
                    if (!choices.includes(randomLetter.tifinagh) && randomLetterIndex !== correctLetterIndex) {
                        choices.push(randomLetter.tifinagh);
                    }
                }

                choices.sort(() => Math.random() - 0.5);

                choicesEl.innerHTML = '';
                choices.forEach(choice => {
                    const button = document.createElement('button');
                    button.textContent = choice;
                    button.classList.add('choice', 'tifinagh'); // Add 'tifinagh' class
                    button.addEventListener('click', () => checkAnswer(choice, currentQuestion.tifinagh, button, isAudioQuestion));
                    choicesEl.appendChild(button);
                });


            } else {
                // Letter Question: Show letter, play audio choices
                questionEl.textContent = currentQuestion.tifinagh;
                questionEl.className = 'tifinagh';

                const choices = [];
                choices.push(currentQuestion.audio);  //Correct audio path

                while(choices.length < 4){
                    const randomLetterIndex = Math.floor(Math.random() * letters.length);
                    const randomLetter = letters[randomLetterIndex];
                    if(!choices.includes(randomLetter.audio) && randomLetterIndex !== correctLetterIndex){
                        choices.push(randomLetter.audio);
                    }
                }

                choices.sort(() => Math.random() - 0.5);
                choicesEl.innerHTML = ''; //Clear previous buttons
                choices.forEach(choiceAudioPath => {
                    const button = document.createElement('button');
                    button.classList.add('choice', 'audio-player');

                    // Create the audio element inside the button
                    const audioElement = new Audio(choiceAudioPath);
                    button.appendChild(audioElement); //  Append audio to the button

                    // Play audio on button click (using event delegation)
                    button.addEventListener('click', () => {
                        // Stop any currently playing audio from other choices
                        document.querySelectorAll('.audio-player audio').forEach(audio => {
                             if (!audio.paused) {
                                 audio.pause();
                                 audio.currentTime = 0;
                             }
                        });

                        // Play this button's audio
                        if (audioElement.paused) {
                            audioElement.play();
                         } else {
                             audioElement.pause();
                             audioElement.currentTime = 0;
                         }

                        checkAnswer(choiceAudioPath, currentQuestion.audio, button, isAudioQuestion);
                    });
                    choicesEl.appendChild(button); // Add the button

                });
            }
            feedbackEl.textContent = '';
            nextButton.style.display = 'none';

        }


    function checkAnswer(selectedChoice, correctChoice, button, isAudioQuestion) {
        const allChoices = document.querySelectorAll('.choice');
        allChoices.forEach(btn => btn.disabled = true);

        if (selectedChoice === correctChoice) {
            score++;
            feedbackEl.textContent = 'Correct!';
            feedbackEl.style.color = '#4caf50';
            button.classList.add('correct');
            gameContainer.classList.add('correct-container');


            questionTimeout = setTimeout(() => {
                gameContainer.classList.remove('correct-container');
                generateQuestion();
            }, 2000);


        } else {
            feedbackEl.textContent = 'Incorrect. Try again!';
            feedbackEl.style.color = '#f44336';
            button.classList.add('incorrect');

            // Find and highlight the correct button
            let correctButton;
            if(isAudioQuestion){
                correctButton = Array.from(allChoices).find(btn => btn.textContent === correctChoice);
            } else { //for audio choice questions
                correctButton = Array.from(allChoices).find(btn => btn.querySelector("audio") && btn.querySelector("audio").src.endsWith(correctChoice));
            }


            if (correctButton) {
                correctButton.classList.add('correct');
            }
            nextButton.style.display = 'block';
        }

        scoreEl.textContent = score;
    }
    nextButton.addEventListener('click', generateQuestion);
    generateQuestion();

    </script>
</body>
</html>
